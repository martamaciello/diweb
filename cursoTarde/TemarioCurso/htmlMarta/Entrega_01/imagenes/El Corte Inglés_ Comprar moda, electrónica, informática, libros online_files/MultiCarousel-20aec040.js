import{c as f,F as O,r as x,n as S,i as d,aa as u,o as m,$ as P,a6 as C}from"./vuex.esm-bundler-f8eff60d.js";import{_ as T}from"./_plugin-vue_export-helper-c27b6911.js";function D(t){return t}function b(t,e=2){return Math.pow(t,e)}function L(t){return Math.log(t*100+1)/Math.log(10)/2}function p({timing:t=D,draw:e,duration:i=1e3,onFinish:s=()=>{}}){let a=performance.now();requestAnimationFrame(function r(l){let o=(l-a)/i;o>1&&(o=1);let g=t(o);e(g),o<1?requestAnimationFrame(r):s(g)})}var I={animate:p,linearTiming:D,parabolicTiming:b,logarithmicTiming:L};const c=Object.freeze({SNAP:"snap",CONTINUOUS:"continuous",STACK:"stack"}),n=Object.freeze({VERTICAL:1,HORIZONTAL:2}),h=Object.freeze({PREVIOUS:1,NEXT:2}),A={name:"MultiCarousel",props:{items:{type:Array,default:()=>[]},visibleItems:{type:Number,default:1},scrollDirection:{type:Number,default:n.HORIZONTAL,validatior:function(t){return Object.keys(n).includes(t)}},fillVisibleSpace:{type:Boolean,default:!1},selectedItemIndex:{type:[Number,null],default:()=>0},itemDragBreakpoint:{type:Number,default:0,validator:function(t){return t>=0&&t<=1}},gestureDirectionBreakpoint:{type:Number,default:60,validator:function(t){return t>=0&&t<=90}},scrollMode:{type:String,default:c.SNAP,validator:function(t){return Object.values(c).includes(t)}},wheelDrag:{type:Boolean,default:!0},mouseDrag:{type:Boolean,default:!0},touchDrag:{type:Boolean,default:!0},arrowDrag:{type:Boolean,default:!1},blockWheelDrag:{type:Boolean,default:!1},wheelDragInterval:{type:Number,default:250,required:!1},disableScroll:{type:Boolean,default:!1},isCdp:{type:Boolean,default:!1},isDesktopDevice:{type:Boolean,default:!1},enableInternalScroll:{type:Boolean,default:!0,required:!1},animateEnabled:{type:Boolean,default:!0,required:!1},animateScrollDuration:{type:Number,default:500,required:!1},animateScrollTiming:{type:Function,default:I.linearTiming,required:!1},animateScrollDraw:{type:[Function,null],default:null,required:!1},showScrollbarThin:{type:Boolean,default:!1,required:!1}},emits:["selected-index","is-dragging","finished-animation"],data(){return{selectedIndex:void 0,lastSelectedIndex:void 0,isMousePressed:!1,isDragging:!1,draggingStartPointX:null,draggingStartPointY:null,draggingLastPointX:null,draggingLastPointY:null,draggingLastOrientationAccumulatedOffset:0,draggingStartScrollOffset:null,draggingStartSelectedIndex:void 0,draggingMovingIndex:void 0,draggingDirection:null,draggingInitialOrientation:null,lastWheelEvent:0,clickPositionRange:30,itemWidth:0,itemWidthPx:"0px",carousel:null,carouselScrollOffset:0,scrollingSlidesPercentage:this.items.map(()=>100),slideObserver:null,finishedMount:!1,isFirstUpdate:!0,scrollItem:null}},computed:{itemCount(){return this.items&&this.items.length?this.items.length:1},itemCssWidth(){const e=this.itemCount<this.visibleItems&&this.fillVisibleSpace===!0?this.itemCount:this.visibleItems;return Math.round(100/e)+"%"},containerClass(){return this.showScrollbarThin?{"horizontal-carousel__container-chabot":this.scrollDirection==n.HORIZONTAL,"vertical-carousel__container":this.scrollDirection==n.VERTICAL,"horizontal-carousel__touch--block":!this.touchDrag,"disable-scroll":this.disableScroll}:{"horizontal-carousel__container":this.scrollDirection==n.HORIZONTAL,"vertical-carousel__container":this.scrollDirection==n.VERTICAL,"horizontal-carousel__touch--block":!this.touchDrag,"disable-scroll":this.disableScroll}},scrollProp(){return this.scrollDirection===n.VERTICAL?"scrollTop":"scrollLeft"}},watch:{selectedIndex(t,e){t!==e&&(this.lastSelectedIndex=e||0)},selectedItemIndex(t){t!==this.selectedIndex&&this.moveToIndex(t)},items(){this.resizeHandler()},carouselScrollOffset(t){this.carousel&&this.enableInternalScroll&&(this.carousel[this.scrollProp]=t)},itemWidth(t){this.itemWidthPx=t+"px"}},mounted(){var t;this.carousel=this.$refs.carousel_container,this.resizeHandler(),window.addEventListener("resize",this.resizeHandler),this.scrollItem=document.getElementsByClassName("horizontal-carousel__container-chabot")[0],(t=this.scrollItem)==null||t.addEventListener("scroll",this.horizontalScrollHandler),this.isCdp&&!this.isDesktopDevice&&this.scrollDirection===n.HORIZONTAL&&this.carousel.addEventListener("scroll",this.checkIndex)},unmounted(){var t;window.removeEventListener("resize",this.resizeHandler),(t=this.scrollItem)==null||t.removeEventListener("scroll",this.horizontalScrollHandler)},updated(){this.isFirstUpdate&&(this.isFirstUpdate=!1,this.finishedMount=!0,this.resizeHandler()),this.calcItemWidth(this.carousel)!==this.itemWidth&&this.resizeHandler()},methods:{itemClass(t){const e=this.isDraggingSlide(t);return{"horizontal-carousel__item":this.scrollDirection==n.HORIZONTAL,"vertical-carousel__item":this.scrollDirection==n.VERTICAL,scrolled:t<=this.selectedIndex&&!e,unscrolled:this.finishedMount&&t>this.selectedIndex&&!e,dragging:e}},isDraggingSlide(t,e){return this.scrollingSlidesPercentage[t]<100&&this.isDragging?e?this.lastSelectedIndex<this.selectedIndex?e===h.NEXT:this.lastSelectedIndex>this.selectedIndex?e===h.PREVIOUS:!1:!0:!1},itemStyle(t){const e=this.scrollingSlidesPercentage[t],i=this.itemWidth-this.itemWidth*(e/100)+"px";return{width:this.itemCssWidth,"--item-index":t,"--item-height":this.itemWidthPx,"--partial-scroll":e,"--partial-scroll-px":i}},setCarouselOffset(t,e=!1){const i=typeof t=="number"?t:this.selectedIndex*this.itemWidth;let s=(i+this.itemWidth)%this.itemWidth/this.itemWidth;if(!this.enableInternalScroll){if(this.carouselScrollOffset=i,this.isDragging){const a=t-this.draggingStartScrollOffset;this.hasChangedOrientation(a)&&(s=this.draggingToNext(a)?0:1),this.scrollingSlidesPercentage=this.scrollingSlidesPercentage.map((r,l)=>l===this.draggingMovingIndex&&s!==0?s*100:100),this.scrollingSlidesPercentage.find(r=>r<100)||this.emitChangedIndex()}else this.emitChangedIndex();return}e&&this.animateEnabled?this.animateScroll(i):(this.scrollingSlidesPercentage[this.selectedIndex]=s*100,this.carouselScrollOffset=i)},animateScroll(t){const e=this,i=this.carouselScrollOffset,s=t-i,a=Math.abs(s/this.itemWidth),r=Math.abs(s)<this.itemWidth?a*this.animateScrollDuration:this.animateScrollDuration,l=this.selectedIndex;I.animate({duration:r,timing:this.animateScrollTiming,draw:o=>{if(o<0)return;const g=o>1?1:o;s>0&&(e.scrollingSlidesPercentage[l]=g*100),e.carouselScrollOffset=i+s*o},onFinish(){e.scrollingSlidesPercentage[l]=100,e.carouselScrollOffset=t,e.emitChangedIndex(!0)}})},blockEvent(t){t.cancelable&&t.preventDefault(),t.stopPropagation()},resizeHandler(){this.itemWidth=this.calcItemWidth(this.carousel),this.selectedIndex=this.selectedItemIndex||0,this.setCarouselOffset(),this.moveToIndex(this.selectedIndex),this.carousel.removeEventListener("scroll",this.checkIndex),this.isCdp&&!this.isDesktopDevice&&this.scrollDirection===n.HORIZONTAL&&this.carousel.addEventListener("scroll",this.checkIndex)},horizontalScrollHandler(){if(this.scrollDirection!==n.HORIZONTAL||!this.scrollItem)return;const t=this.scrollItem.scrollWidth-this.scrollItem.clientWidth,e=this.scrollItem.scrollLeft/t,i=1/this.items.length;let s=Math.floor(e/i);s>=this.items.length&&(s=this.items.length-1),this.setCarouselOffset(this.scrollItem.scrollLeft),this.selectedIndex=s},checkIndex(){const t=this.carousel.scrollWidth-this.carousel.clientWidth,e=this.carousel.scrollLeft/t,i=1/this.items.length;let s=Math.floor(e/i);s>=this.items.length&&(s=this.items.length-1),this.setSelectedIndex(s,!0)},hasMovedPointer(t){const e=this.getCurrentPosition(t),i=this.getDraggingStartPoint();return i&&(i+this.clickPositionRange<e||i-this.clickPositionRange>e)},calcItemWidth(t){const e=t.getBoundingClientRect();if(this.scrollDirection===n.HORIZONTAL)return this.scrollMode===c.STACK?e.width*this.visibleItems:Math.ceil(t.scrollWidth/this.itemCount);if(this.scrollDirection===n.VERTICAL)return this.scrollMode===c.STACK?e.height*this.visibleItems:Math.ceil(t.scrollHeight/this.itemCount)+1},resetDragging(){this.isMousePressed=!1,this.isDragging=!1,this.draggingStartPointX=null,this.draggingStartPointY=null,this.draggingLastPointX=null,this.draggingLastPointY=null,this.draggingLastOrientationAccumulatedOffset=0,this.draggingMovingIndex=void 0,this.draggingStartScrollOffset=null,this.draggingStartSelectedIndex=void 0,this.draggingDirection=null,this.draggingInitialOrientation=null,this.$emit("is-dragging",!1)},getDraggingStartPoint(){return this.scrollDirection==n.HORIZONTAL?this.draggingStartPointX:this.draggingStartPointY},getCurrentPosition(t){let e,i;return t.type==="touchmove"?(e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY):t.type==="mousemove"&&(e=t.pageX,i=t.pageY),this.scrollDirection==n.HORIZONTAL?e:i},mouseDown(t){t.target.offsetHeight==t.target.clientHeight&&(this.draggingStartPointX=t.pageX,this.draggingStartPointY=t.pageY,this.draggingStartScrollOffset=this.carouselScrollOffset,this.draggingStartSelectedIndex=this.selectedIndex,this.lastSelectedIndex=this.selectedIndex,this.isMousePressed=!0)},touchStart(t){this.draggingStartPointX=t.touches[0].pageX,this.draggingStartPointY=t.touches[0].pageY,this.draggingStartScrollOffset=this.carouselScrollOffset,this.draggingStartSelectedIndex=this.selectedIndex,this.lastSelectedIndex=this.selectedIndex},touchMove(t){if(!this.touchDrag)return;const e=this.getDraggingStartPoint();if(e!==null){this.isDragging=!0,this.$emit("is-dragging",!0);const i=t.touches[0].pageX,s=t.touches[0].pageY;if(this.draggingDirection===null&&(this.draggingDirection=this.isHorizontalScroll(i,s)?n.HORIZONTAL:n.VERTICAL),this.draggingDirection==this.scrollDirection){const a=this.getCurrentPosition(t),r=e-a;this.setDraggingState(t,i,s,r),this.moveItem(r),this.blockEvent(t)}}},touchEnd(t){this.isDragging?(this.stopDragging(),this.draggingDirection==this.scrollDirection&&this.blockEvent(t)):this.hasMovedPointer(t)&&this.blockEvent(t)},click(t){this.isMousePressed=!1,this.isDragging&&(this.blockEvent(t),this.stopDragging())},mouseLeave(t){this.isMousePressed=!1,this.isDragging&&(this.stopDragging(),this.blockEvent(t))},mouseUp(t){this.isMousePressed=!1,this.isDragging&&(this.blockEvent(t),this.stopDragging())},mouseMove(t){if(this.isMousePressed){const e=this.getCurrentPosition(t),i=this.getDraggingStartPoint()-e;if(Math.abs(i)>10||this.isDragging){this.isDragging=!0,this.$emit("is-dragging",!0);const s=t.pageX,a=t.pageY;this.draggingDirection===null&&(this.draggingDirection=this.isHorizontalScroll(s,a)?n.HORIZONTAL:n.VERTICAL),this.draggingDirection==this.scrollDirection&&(this.setDraggingState(t,s,a,i),this.moveItem(i),this.blockEvent(t))}}},setDraggingState(t,e,i,s){this.draggingLastOrientationAccumulatedOffset=this.calculateDraggingAccumulatedOffset(t),this.draggingLastPointX=e,this.draggingLastPointY=i,this.draggingInitialOrientation||(this.draggingInitialOrientation=this.calculateDraggingOrientation(s),this.draggingInitialOrientation===h.PREVIOUS?this.draggingMovingIndex=this.draggingStartSelectedIndex:this.draggingMovingIndex=Math.min(this.itemCount-1,this.draggingStartSelectedIndex+1))},moveItem(t){if(this.itemCount<=this.visibleItems)return;const e=this.draggingStartScrollOffset+t;this.setCarouselOffset(e);let i=this.selectedIndex;i=this.calculateItemIndexOnDragging(this.draggingLastOrientationAccumulatedOffset),this.enableInternalScroll?(this.hasReachedEndLimit()&&(i=this.itemCount-1),this.hasReachedStartLimit()&&(i=0)):(i>=this.itemCount&&(i=this.itemCount-1),i<0&&(i=0)),this.setSelectedIndex(i,!1)},calculateDraggingOrientation(t){return this.draggingToNext(t)?h.NEXT:h.PREVIOUS},calculateDraggingAccumulatedOffset(t){const e=this.getCurrentPosition(t),s=this.getDraggingLastPosition()-e;return s>=0&&this.draggingLastOrientationAccumulatedOffset>=0||s<=0&&this.draggingLastOrientationAccumulatedOffset<=0?this.draggingLastOrientationAccumulatedOffset+s:s},getDraggingLastPosition(){return this.scrollDirection===n.HORIZONTAL?this.draggingLastPointX:this.draggingLastPointY},hasChangedOrientation(t){const e=this.calculateDraggingOrientation(t);return this.draggingInitialOrientation!==e},calculateItemIndexOnDragging(t){const e=this.carouselScrollOffset/this.itemWidth;let i=this.selectedIndex;return this.scrollMode===c.STACK&&this.hasChangedOrientation(t)?this.draggingStartSelectedIndex:(this.draggingToNext(t)?e%1>this.itemDragBreakpoint&&(i=Math.ceil(e)):e%1<1-this.itemDragBreakpoint&&(i=Math.floor(e)),i)},calculateAngle(t,e){let i=Math.atan2(e,t);return i*=180/Math.PI,i},calculateDragAngle(t,e){const i=e-this.draggingStartPointY,s=t-this.draggingStartPointX;return this.calculateAngle(s,i)},calculateWheelAngle(t){return this.calculateAngle(t.deltaX,t.deltaY)},isVerticalScroll(t,e){const i=Math.abs(this.calculateDragAngle(t,e));return i>this.gestureDirectionBreakpoint&&i<180-this.gestureDirectionBreakpoint},isHorizontalScroll(t,e){const i=Math.abs(this.calculateDragAngle(t,e));return i<this.gestureDirectionBreakpoint||i>180-this.gestureDirectionBreakpoint},isHorizontalWheelScroll(t){const e=Math.abs(this.calculateWheelAngle(t));return e<this.gestureDirectionBreakpoint||e>180-this.gestureDirectionBreakpoint},moveToIndex(t){this.setSelectedIndex(t,!1),this.setCarouselOffset(this.itemWidth*t,!0)},stopDragging(){this.setCarouselOffset(this.selectedIndex*this.itemWidth,!0),setTimeout(()=>this.resetDragging(),100)},handleWheelScroll(t){const e=this.isHorizontalWheelScroll(t)?n.HORIZONTAL:n.VERTICAL;if(this.isCdp&&!this.isDesktopDevice&&e===n.HORIZONTAL||e!==this.scrollDirection)return;const i=Date.now(),s=i-this.lastWheelEvent<this.wheelDragInterval;if(this.lastWheelEvent=i,this.isDragging||this.blockWheelDrag||s){this.blockEvent(t);return}this.blockEvent(t);const a=this.getNewIndex(t);this.moveToIndex(a)},getNewIndex(t){let e=this.selectedIndex;return this.scrollToEnd(t)?e=this.selectedIndex<this.itemCount-1?this.selectedIndex+1:this.itemCount-1:this.scrollToStart(t)&&(e=this.selectedIndex>0?this.selectedIndex-1:0),e},hasReachedEndLimit(){if(this.scrollDirection===n.HORIZONTAL)return this.carouselScrollOffset>=this.carousel.scrollWidth-this.carousel.clientWidth;if(this.scrollDirection===n.VERTICAL)return this.carouselScrollOffset>=this.carousel.scrollHeight-this.carousel.clientHeight},hasReachedStartLimit(){return this.carouselScrollOffset<=0},hasReachedCarouselLimit(t){return this.scrollToStart(t)&&this.selectedIndex==0||this.scrollToEnd(t)&&this.selectedIndex==this.itemCount-1},scrollToEnd(t){return this.scrollDirection===n.VERTICAL?t.deltaY>0:t.deltaX<0},scrollToStart(t){return this.scrollDirection===n.VERTICAL?t.deltaY<0:t.deltaX>0},draggingToNext(t){return t>0},setSelectedIndex(t,e=!0){t!==this.selectedIndex&&(this.selectedIndex=t,e&&this.emitChangedIndex())},emitChangedIndex(t){if(this.scrollMode===c.STACK){const e=this.selectedIndex;this.$emit("selected-index",e),setTimeout(()=>{this.$emit("finished-animation",e)},this.animateScrollDuration)}else{this.$emit("selected-index",this.selectedIndex),t&&this.$emit("finished-animation",this.selectedIndex);return}}}};function E(t,e,i,s,a,r){return m(),f("div",{ref:"carousel_container",class:S(r.containerClass),onClickCapture:e[0]||(e[0]=d(l=>r.click(l),["left"])),onWheel:e[1]||(e[1]=l=>!i.disableScroll&&i.wheelDrag&&r.handleWheelScroll(l)),onMousedown:e[2]||(e[2]=d(l=>!i.disableScroll&&i.mouseDrag&&r.mouseDown(l),["left","prevent"])),onMouseup:e[3]||(e[3]=d(l=>!i.disableScroll&&i.mouseDrag&&r.mouseUp(l),["left","prevent"])),onMousemove:e[4]||(e[4]=d(l=>!i.disableScroll&&i.mouseDrag&&r.mouseMove(l),["left","prevent"])),onMouseleave:e[5]||(e[5]=l=>!i.disableScroll&&i.mouseDrag&&r.mouseLeave(l)),onTouchstart:e[6]||(e[6]=l=>!i.disableScroll&&r.touchStart(l)),onTouchmove:e[7]||(e[7]=l=>!i.disableScroll&&r.touchMove(l)),onTouchend:e[8]||(e[8]=l=>!i.disableScroll&&r.touchEnd(l)),onKeyup:[e[9]||(e[9]=u(l=>!i.disableScroll&&t.keyDrag,["right"])),e[10]||(e[10]=u(l=>!i.disableScroll&&t.keyDrag,["left"])),e[11]||(e[11]=u(l=>!i.disableScroll&&t.keyDrag,["down"])),e[12]||(e[12]=u(l=>!i.disableScroll&&t.keyDrag,["up"]))]},[(m(!0),f(O,null,x(i.items,(l,o)=>(m(),f("div",{key:"carousel_item_".concat(l.id?l.id:o),ref_for:!0,ref:"carousel_item",class:S(r.itemClass(o)),style:P(r.itemStyle(o))},[C(t.$slots,"default",{item:l,index:o})],6))),128))],34)}const k=T(A,[["render",E]]);export{k as M,I as a};
//# sourceMappingURL=MultiCarousel-20aec040.js.map

import{_ as x}from"./Render-4448ec15.js";import{a as C}from"./useBadgeLink-a2b300bc.js";import{_ as B}from"./_plugin-vue_export-helper-c27b6911.js";import{o as d,c,t as y,n as h,a as L,N as A,z as b,h as _,f as k,F as v,r as U,k as W,g as O,j as T,a4 as N,aJ as V}from"./vuex.esm-bundler-f8eff60d.js";import{c as f}from"./state-0c727e5f.js";const R={props:{customClass:{type:String,required:!1,default:""},label:{type:String,required:!0},promoBadgeUrl:{type:String,required:!0},windowType:{type:String,required:!1,default:"3"}},emits:["promoSelected"],setup(i,{emit:r}){const{isOpenInModal:e,openInModal:t,target:n}=C(i,r);return{isOpenInModal:e,openInModal:t,target:n}}},G=["href","target"];function D(i,r,e,t,n,u){return t.isOpenInModal?(d(),c("span",{key:0,class:h(["promo-badges__text pointer underline",e.customClass]),onClick:r[0]||(r[0]=(...a)=>t.openInModal&&t.openInModal(...a))},y(e.label),3)):(d(),c("a",{key:1,href:e.promoBadgeUrl,target:t.target},[L("span",{class:h(["promo-badges__text",e.customClass])},y(e.label),3)],8,G))}const E=B(R,[["render",D]]),F={components:{PromoBadgeLink:E,ModalWithIframe:A(()=>x(()=>import("./ModalWithIframe-1892b939.js"),[window.__assetsPath("assets/ModalWithIframe-1892b939.js"),window.__assetsPath("assets/Modal-4b0c1909.js"),window.__assetsPath("assets/vuex.esm-bundler-f8eff60d.js"),window.__assetsPath("assets/_plugin-vue_export-helper-c27b6911.js"),window.__assetsPath("assets/Spinner-4fecf309.js"),window.__assetsPath("assets/Spinner-6db6c11d.css")],import.meta.url))},props:{badgePromotions:{type:Array,default:()=>[],required:!0},isIaChat:{type:Boolean,default:!1,required:!1},labelProp:{type:String,required:!0}},setup(i){const r=b(""),e=b(!1),t=_(()=>i.badgePromotions.filter(o=>o[i.labelProp]));function n(){e.value=!1}function u(o){r.value=o,e.value=!0}function a(o){return o!=null&&o.promo_url_badge_text_windows_type?o.promo_url_badge_text_windows_type:null}return{iframeUrl:r,filteredBadgePromotions:t,showPromotionIframe:e,closeModal:n,setPromotionIframeAsVisible:u,getWindowType:a}}},j={key:0},z={key:1,class:"promo-badges__text"};function J(i,r,e,t,n,u){const a=k("PromoBadgeLink"),o=k("ModalWithIframe");return d(),c(v,null,[(d(!0),c(v,null,U(t.filteredBadgePromotions,l=>(d(),c("div",{key:l.id,class:"promo-badges"},[l.promo_url_badge_text&&!e.isIaChat?(d(),c("div",j,[W(a,{label:l[e.labelProp],promoBadgeUrl:l.promo_url_badge_text,windowType:t.getWindowType(l),onPromoSelected:t.setPromotionIframeAsVisible},null,8,["label","promoBadgeUrl","windowType","onPromoSelected"])])):(d(),c("span",z,y(l[e.labelProp]),1))]))),128)),t.showPromotionIframe?(d(),O(o,{key:0,iframeURL:t.iframeUrl,onCloseModal:t.closeModal},null,8,["iframeURL","onCloseModal"])):T("",!0)],64)}const ee=B(F,[["render",J]]);function te(i,r){const e=f("filter/getActiveFilterModuleName").value,{badgePromotions:t,promosPerProduct:n}=N(i),u=_(()=>{var s;return((s=a==null?void 0:a.value)==null?void 0:s.promos_per_product)||(n==null?void 0:n.value)||1});let a,o;e==="search-filters"?(a=f("search-filters/getLayoutOptions"),o=f("search-filters/getGiftsWithStock")):(a=f("page/getLayoutOptions"),o=f("page/getGiftsWithStock"));const l=_(()=>{const s=t.value;if(!Array.isArray(s))return[];const w=s.filter(m=>{var P;const g=m[r]&&m.priority,M=((P=m.target_references)==null?void 0:P.length)&&!m.target_references.some(p=>{const q=p.includes(":")?p.split(":")[0]:p;return o.value.includes(q)});return g&&!M}).sort((m,g)=>m.priority-g.priority);return V.uniqBy(w,r)}),I=_(()=>{var s;return((s=l.value)==null?void 0:s.length)>u.value}),S=_(()=>{var s;return(s=l.value)==null?void 0:s.slice(0,u.value)});return{hasSeveralPrincipalPromos:I,promotionsDisplayed:S}}export{ee as P,E as a,te as u};
//# sourceMappingURL=useBadgeText-13c8b587.js.map

import{h as l,z as I,G as O}from"./vuex.esm-bundler-f8eff60d.js";import{m as E}from"./marketplace-0851b6dd.js";import{e as T}from"./state-0c727e5f.js";const A=({product:t,color:g})=>{const f=l(()=>{if(!t.value||!g.value)return;const{min_discount:o,price:n,sale_price:p,stock:i}=t.value,d={discount:o,unit_price:n,unit_sale_price:p},e=_(g.value.variants);if(!(e!=null&&e.price))return d;const m=E.updatePriceProductPreviewFromMarketplace(i,e==null?void 0:e.stockReference);if(m)return m;const a=e==null?void 0:e.pumOrPackComposition;return{discount:e.discount,lot_price:u(e.lot_price),unit_price:e.price,unit_price_agrupation:e.unit_price,unit_price_pum:u(e.unit_price_pum),unit_sale_price:u(e.sale_price),...a&&{pumOrPackComposition:a}}}),_=o=>{if(!(o!=null&&o.length))return;const[n]=o;return o.length===1?n:o.reduce((i,d)=>{const{sale_price:e,price:m}=d,{sale_price:a,price:P}=i,C=u(e||m),v=u(a||P);return C<v?d:i},n)},u=o=>{if(typeof o!="string")return o;const n=o.split(","),p=n[0].replace(".",""),i=n[1];return i?+(p+"."+i):Number(p)};return{price:f}},b="compareProducts",c=I([]),J=()=>{if(typeof window>"u")return;const t=sessionStorage.getItem(b);return t?JSON.parse(t):void 0},k=()=>{if(typeof window>"u")return;const t=JSON.stringify(c.value);return sessionStorage.setItem(b,t)},R=()=>{const t=J()||[];c.value=t};R();const K=t=>{const{t:f}=O(),_=f("comparator.product.limitExceeded",{limit:4}),{addMessage:u}=T("toastMessageState",{addMessage:"addMessage"}),o=l(()=>{const{_my_colors:r}=t.value;if(!(r!=null&&r.length))return;const s=r.find(({preselected:h})=>h);if(s)return s;const[y]=r;return y}),{price:n}=A({product:t,color:o}),p=()=>{var M,S;const{id:r,title:s,brand:y,_base_url:h,categories:L}=t.value,{image:N,hasPriceRange:x}=(M=o.value)!=null?M:{};return{id:r,_base_url:h,title:s,brand:y,image:N,hasPriceRange:x,price:n.value,category:(S=L[0])==null?void 0:S.name}},i=()=>{const r=p();c.value=[...c.value,r],k()},d=()=>{c.value=c.value.filter(({id:r})=>{var s;return r!==((s=t.value)==null?void 0:s.id)}),k()},e=()=>{c.value=[],k()},m=l(()=>c.value.length>=4),a=l(()=>c.value.some(({id:r})=>{var s;return r===((s=t.value)==null?void 0:s.id)})),P=l(()=>!a.value&&m.value),C=l(()=>!c.value.length),v=()=>{var r;if(a.value)return d();if(!m.value){if(C.value){const s=f("comparator.product.onlySameCategory",{category:(r=t.value.categories[0])==null?void 0:r.name});u(s)}return i()}return u(_)},w=l({get:()=>a.value,set:v});return{clearProducts:e,inputCheckDisabled:P,productCompareModel:w,productsLimit:4,productsToCompare:c,removeProduct:d,toggleCompare:v}};export{A as a,K as u};
//# sourceMappingURL=useProductCompare-653ec34a.js.map
